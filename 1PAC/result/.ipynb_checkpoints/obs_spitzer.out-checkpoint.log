FLAGS.seq_len change from 1 to 16 due to FLAGS.vocab_dim = 16 and FLAGS.hidden_dim = 256.
mlpCompressor(
  (input_map): Embedding(256, 16)
  (output_logit_map): Linear(in_features=256, out_features=256, bias=True)
  (layers): ModuleList(
    (0): BELayer(
      (V_map): dense_baens()
      (layernorm1): LayerNorm((16,), eps=1e-05, elementwise_affine=True)
      (layernorm2): LayerNorm((16,), eps=1e-05, elementwise_affine=True)
    )
    (1): LinearLayer(
      (U_map): Linear(in_features=256, out_features=4096, bias=True)
      (V_map): Linear(in_features=4096, out_features=256, bias=True)
      (layernorm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
      (layernorm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
    )
    (2): BELayer(
      (V_map): dense_baens()
      (layernorm1): LayerNorm((32,), eps=1e-05, elementwise_affine=False)
      (layernorm2): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
    )
    (3): LinearLayer(
      (U_map): Linear(in_features=256, out_features=4096, bias=True)
      (V_map): Linear(in_features=4096, out_features=256, bias=True)
      (layernorm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
      (layernorm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
    )
    (4): BELayer(
      (V_map): dense_baens()
      (layernorm1): LayerNorm((64,), eps=1e-05, elementwise_affine=False)
      (layernorm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
    )
    (5): LinearLayer(
      (U_map): Linear(in_features=256, out_features=4096, bias=True)
      (V_map): Linear(in_features=4096, out_features=256, bias=True)
      (layernorm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
      (layernorm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
    )
    (6): BELayer(
      (V_map): dense_baens()
      (layernorm1): LayerNorm((128,), eps=1e-05, elementwise_affine=False)
      (layernorm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
    (7): LinearLayer(
      (U_map): Linear(in_features=256, out_features=4096, bias=True)
      (V_map): Linear(in_features=4096, out_features=256, bias=True)
      (layernorm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
      (layernorm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
    )
  )
)
387055
999 : 5.389803163468655 size: 0.0
1999 : 5.299335817565895 size: 0.0
2999 : 4.9784172229518 size: 0.0
3999 : 4.557548846996972 size: 0.0
4999 : 4.246449773816539 size: 0.0
5999 : 3.9523996847814384 size: 0.0
6999 : 3.7160631897575773 size: 0.0
7999 : 3.5237232964774394 size: 0.0
8999 : 3.587627234023835 size: 0.0
9999 : 3.3983304017680642 size: 0.0
10999 : 3.283262657485888 size: 0.0
11999 : 3.0188623774595356 size: 0.0
12999 : 2.9700574847629895 size: 0.0
13999 : 2.9099873844696273 size: 0.0
14999 : 2.985775667155945 size: 0.0
15999 : 3.063105946289898 size: 0.0
16999 : 3.094151566493049 size: 0.0
17999 : 2.9483188776939304 size: 0.0
18999 : 2.9793149668936327 size: 0.0
19999 : 2.8139653429093006 size: 0.0
20999 : 2.5513519626254126 size: 0.0
21999 : 2.790092603125685 size: 0.0
22999 : 2.6908900864029524 size: 0.0
23999 : 2.8210161156467235 size: 0.0
24999 : 3.0073894148204774 size: 0.0
25999 : 2.901363142459461 size: 0.0
26999 : 2.6190293715143893 size: 0.0
27999 : 2.4568523114905236 size: 0.0
28999 : 2.4922888207528526 size: 0.0
29999 : 2.471192740867417 size: 0.0
30999 : 2.545927285851898 size: 0.0
31999 : 2.721213895420432 size: 0.0
32999 : 2.787748651577076 size: 0.0
33999 : 2.719577824462774 size: 0.0
34999 : 2.5557672732210137 size: 0.0
35999 : 2.56348052312956 size: 0.0
36999 : 2.4977109177866046 size: 0.0
37999 : 2.40520351367931 size: 0.0
38999 : 2.7386911163664123 size: 0.0
39999 : 2.7187648624721454 size: 0.0
40999 : 2.7999644072852106 size: 0.0
41999 : 2.837054701718236 size: 0.0
42999 : 2.509714446903574 size: 0.0
43999 : 2.5722696965019036 size: 0.0
44999 : 2.3866572485755664 size: 0.0
45999 : 2.287880732879021 size: 0.0
46999 : 2.4758880392186224 size: 0.0
47999 : 2.507136426967141 size: 0.0
48999 : 2.451631434158281 size: 0.0
49999 : 2.7053579549241356 size: 0.0
50999 : 2.5495808852868276 size: 0.0
51999 : 2.423440553976802 size: 0.0
52999 : 2.3443670586937033 size: 0.0
53999 : 2.346877317465697 size: 0.0
54999 : 2.363706507783226 size: 0.0
55999 : 2.5709070779591174 size: 0.0
56999 : 2.6097436842290045 size: 0.0
57999 : 2.630748269344181 size: 0.0
58999 : 2.5752434485179725 size: 0.0
59999 : 2.463601254675682 size: 0.0
60999 : 2.44003223625349 size: 0.0
61999 : 2.24051808669261 size: 0.0
62999 : 2.2377127056917363 size: 0.0
63999 : 2.399785200263877 size: 0.0
64999 : 2.554209626352149 size: 0.0
65999 : 2.680964623656358 size: 0.0
66999 : 2.5919713410541436 size: 0.0
67999 : 2.3522471317735865 size: 0.0
68999 : 2.329873564757542 size: 0.0
69999 : 2.2876172554578993 size: 0.0
70999 : 2.2766800187762786 size: 0.0
71999 : 2.3647313523997178 size: 0.0
72999 : 2.481089826476619 size: 0.0
73999 : 2.5844008367458136 size: 0.0
74999 : 2.4949237669467217 size: 0.0
75999 : 2.354420304549889 size: 0.0
76999 : 2.1202349685230195 size: 0.0
77999 : 2.2042472895909455 size: 0.0
78999 : 2.2474978305952265 size: 0.0
79999 : 2.3537777773662656 size: 0.0
80999 : 2.5352862032950636 size: 0.0
81999 : 2.4707658799279755 size: 0.0
82999 : 2.464337168438724 size: 0.0
83999 : 2.4257026417836007 size: 0.0
84999 : 2.3316941730995757 size: 0.0
85999 : 2.2935967482630972 size: 0.0
86999 : 2.332046221585892 size: 0.0
87999 : 2.3668126864404595 size: 0.0
88999 : 2.48157636539591 size: 0.0
89999 : 2.570900198653083 size: 0.0
90999 : 2.59048369112418 size: 0.0
91999 : 2.525067166163446 size: 0.0
92999 : 2.357567759043329 size: 0.0
93999 : 2.0779098661630315 size: 0.0
94999 : 2.1263124914392098 size: 0.0
95999 : 2.233670425465857 size: 0.0
96999 : 2.377745795538459 size: 0.0
97999 : 2.4416223878433674 size: 0.0
98999 : 2.6065477306280207 size: 0.0
99999 : 2.2738810011334865 size: 0.0
100999 : 2.3070120829609997 size: 0.0
101999 : 2.1894065626826924 size: 0.0
102999 : 2.175135958262049 size: 0.0
103999 : 2.0544925364389006 size: 0.0
104999 : 2.290244806397781 size: 0.0
105999 : 2.38810310672137 size: 0.0
106999 : 2.4545105957163753 size: 0.0
107999 : 2.441087865764486 size: 0.0
108999 : 2.248826224590491 size: 0.0
109999 : 2.1737028268324092 size: 0.0
110999 : 2.190235175094549 size: 0.0
111999 : 2.2107060980440987 size: 0.0
112999 : 2.360414759845712 size: 0.0
113999 : 2.2736077207012655 size: 0.0
114999 : 2.2982734724880096 size: 0.0
115999 : 2.373747026923248 size: 0.0
116999 : 2.2920165716669696 size: 0.0
117999 : 2.2526674570975116 size: 0.0
118999 : 2.0733404591122575 size: 0.0
119999 : 1.9611522203534777 size: 0.0
120999 : 2.3291579449473017 size: 0.0
121999 : 2.383162561110034 size: 0.0
122999 : 2.54210858307214 size: 0.0
123999 : 2.3702397847242027 size: 0.0
124999 : 2.2529544961418018 size: 0.0
125999 : 2.3125003933153336 size: 0.0
126999 : 2.1987232068452323 size: 0.0
127999 : 2.0865022913827884 size: 0.0
128999 : 2.2446657922834685 size: 0.0
129999 : 2.34245478359876 size: 0.0
130999 : 2.4003756167042893 size: 0.0
131999 : 2.4112715775497024 size: 0.0
132999 : 2.2399440086040303 size: 0.0
133999 : 2.0757064244401775 size: 0.0
134999 : 1.9767997178769288 size: 0.0
135999 : 1.984015249993878 size: 0.0
136999 : 2.0861626256473342 size: 0.0
137999 : 2.251012124082957 size: 0.0
138999 : 2.3835746315415016 size: 0.0
139999 : 2.383631213833635 size: 0.0
140999 : 2.3525828419080708 size: 0.0
141999 : 2.145621155634228 size: 0.0
142999 : 1.9555055139776991 size: 0.0
143999 : 2.093309880651891 size: 0.0
144999 : 2.1814470336181104 size: 0.0
145999 : 2.097466701323245 size: 0.0
146999 : 2.244116651679264 size: 0.0
147999 : 2.2163407656343166 size: 0.0
148999 : 2.3084087540686564 size: 0.0
149999 : 2.148947988032518 size: 0.0
150999 : 2.0314040375432194 size: 0.0
151999 : 1.9311085710742537 size: 0.0
152999 : 2.039302168801443 size: 0.0
153999 : 2.311292387175673 size: 0.0
154999 : 2.25040674515192 size: 0.0
155999 : 2.3932974987253797 size: 0.0
156999 : 2.3414854893784973 size: 0.0
157999 : 2.191153046502204 size: 0.0
158999 : 2.0854249920577836 size: 0.0
159999 : 2.0376004004711556 size: 0.0
160999 : 2.0690463962855152 size: 0.0
161999 : 2.092967291211372 size: 0.0
162999 : 2.2294924509284466 size: 0.0
163999 : 2.323545463119045 size: 0.0
164999 : 2.3324354183247946 size: 0.0
165999 : 2.2961833673320737 size: 0.0
166999 : 2.157520291282124 size: 0.0
167999 : 1.9717829839512606 size: 0.0
168999 : 1.9428928223113733 size: 0.0
169999 : 2.1742951350819806 size: 0.0
170999 : 2.4287957497593684 size: 0.0
171999 : 2.3675986471549026 size: 0.0
172999 : 2.3658540551445504 size: 0.0
173999 : 2.3581502642818015 size: 0.0
174999 : 2.130146672657545 size: 0.0
175999 : 2.0551132218258648 size: 0.0
176999 : 1.8235028100477133 size: 0.0
177999 : 2.0866417693126382 size: 0.0
178999 : 2.1112077711618817 size: 0.0
179999 : 2.4020025725814516 size: 0.0
180999 : 2.2702370327270054 size: 0.0
181999 : 2.402804183717123 size: 0.0
182999 : 2.1878960390601643 size: 0.0
183999 : 2.1520263055003115 size: 0.0
184999 : 2.0460483602641877 size: 0.0
185999 : 2.082363700872426 size: 0.0
186999 : 2.1260292360132387 size: 0.0
187999 : 2.1926102555029647 size: 0.0
188999 : 2.2548791539876074 size: 0.0
189999 : 2.286205449876966 size: 0.0
190999 : 2.28127883486035 size: 0.0
191999 : 2.1015053699134563 size: 0.0
192999 : 1.8563996515047514 size: 0.0
193999 : 2.005402840472526 size: 0.0
194999 : 2.155596493349573 size: 0.0
195999 : 2.21874129947506 size: 0.0
196999 : 2.2961651371710823 size: 0.0
197999 : 2.2473776147222733 size: 0.0
198999 : 2.164614575630215 size: 0.0
199999 : 2.037096835269429 size: 0.0
200999 : 1.8929924001288312 size: 0.0
201999 : 1.9783594285376034 size: 0.0
202999 : 2.071730185552229 size: 0.0
203999 : 2.227740463664107 size: 0.0
204999 : 2.356825825887507 size: 0.0
205999 : 2.3228802342255075 size: 0.0
206999 : 2.0959759557055664 size: 0.0
207999 : 2.1922119436835663 size: 0.0
208999 : 1.8959854142017967 size: 0.0
209999 : 1.9438024385517867 size: 0.0
210999 : 1.9869413628156576 size: 0.0
211999 : 2.1329904057895614 size: 0.0
212999 : 2.2801867450273714 size: 0.0
213999 : 2.3029992117684177 size: 0.0
214999 : 2.1901005126789235 size: 0.0
215999 : 2.1364684109379604 size: 0.0
216999 : 1.8904037172680441 size: 0.0
217999 : 1.9851226462827833 size: 0.0
218999 : 2.030978208499683 size: 0.0
219999 : 2.154732624494289 size: 0.0
220999 : 2.1739979490612895 size: 0.0
221999 : 2.306958768339232 size: 0.0
222999 : 2.2718591730899433 size: 0.0
223999 : 2.0542053254119597 size: 0.0
224999 : 2.195220952143062 size: 0.0
225999 : 1.8186585747208606 size: 0.0
226999 : 2.1023876409123825 size: 0.0
227999 : 2.245079066593492 size: 0.0
228999 : 2.400839969861619 size: 0.0
229999 : 2.287282749201971 size: 0.0
230999 : 2.318838985895533 size: 0.0
231999 : 1.9685448946008155 size: 0.0
232999 : 2.004295788148922 size: 0.0
233999 : 1.8898802020788177 size: 0.0
234999 : 2.0919759832117992 size: 0.0
235999 : 2.077234834258395 size: 0.0
236999 : 2.234458621954761 size: 0.0
237999 : 2.3796267697909457 size: 0.0
238999 : 2.1559236043515138 size: 0.0
239999 : 2.055075041677373 size: 0.0
240999 : 1.9936531577482297 size: 0.0
241999 : 1.9179773517155765 size: 0.0
242999 : 2.0096399770418327 size: 0.0
243999 : 2.043959115021506 size: 0.0
244999 : 2.2001632175809065 size: 0.0
245999 : 2.1243345189716365 size: 0.0
246999 : 2.0700671133183857 size: 0.0
247999 : 2.107550904056586 size: 0.0
248999 : 2.022639457689949 size: 0.0
249999 : 1.8590089722836418 size: 0.0
250999 : 1.8378872669832278 size: 0.0
251999 : 2.0890632850367865 size: 0.0
252999 : 2.1124962651821457 size: 0.0
253999 : 2.1325919219875127 size: 0.0
254999 : 2.2575091126846014 size: 0.0
255999 : 2.1863776042356964 size: 0.0
256999 : 2.027055972164106 size: 0.0
257999 : 2.105675605231578 size: 0.0
258999 : 1.8746556098938385 size: 0.0
259999 : 2.017515062624841 size: 0.0
260999 : 2.253033092213246 size: 0.0
261999 : 2.2883502455158764 size: 0.0
262999 : 2.2519865777827457 size: 0.0
263999 : 2.163089949430316 size: 0.0
264999 : 1.992144697917512 size: 0.0
265999 : 1.9070186172025985 size: 0.0
266999 : 1.8771715440933106 size: 0.0
267999 : 1.9644491277705178 size: 0.0
268999 : 2.097984541084993 size: 0.0
269999 : 2.3060660063986034 size: 0.0
270999 : 2.2246621461963136 size: 0.0
271999 : 2.19856326297993 size: 0.0
272999 : 2.135594051140974 size: 0.0
273999 : 2.0328411245738294 size: 0.0
274999 : 1.7752355351177644 size: 0.0
275999 : 2.1294828196252147 size: 0.0
276999 : 2.1232451808610713 size: 0.0
277999 : 2.2144276306261186 size: 0.0
278999 : 2.2412237315091006 size: 0.0
279999 : 2.045169012970326 size: 0.0
280999 : 1.9262651956606553 size: 0.0
281999 : 2.0857447078057376 size: 0.0
282999 : 1.8180817449098667 size: 0.0
283999 : 1.8169454555356161 size: 0.0
284999 : 2.0345356696327803 size: 0.0
285999 : 2.1638191558699744 size: 0.0
286999 : 2.2726021381416706 size: 0.0
287999 : 2.14772639526344 size: 0.0
288999 : 2.1256783914054784 size: 0.0
289999 : 1.7481425921793936 size: 0.0
290999 : 2.002402947093526 size: 0.0
291999 : 1.861528518118782 size: 0.0
292999 : 2.0122594447971243 size: 0.0
293999 : 2.111356708137529 size: 0.0
294999 : 2.2304841028933216 size: 0.0
295999 : 2.1861249617215788 size: 0.0
296999 : 2.125600139299336 size: 0.0
297999 : 1.953473882923057 size: 0.0
298999 : 2.1061673036303947 size: 0.0
299999 : 1.8460724372857413 size: 0.0
300999 : 1.9914393970663236 size: 0.0
301999 : 2.1219326092696864 size: 0.0
302999 : 2.143278407964175 size: 0.0
303999 : 2.1553873624461235 size: 0.0
304999 : 2.0853248981549815 size: 0.0
305999 : 2.0502846369202405 size: 0.0
306999 : 1.9203930200295956 size: 0.0
307999 : 1.7997571654430853 size: 0.0
308999 : 1.8985140751174325 size: 0.0
309999 : 2.130159055408407 size: 0.0
310999 : 2.0643817108461633 size: 0.0
311999 : 2.267644222282598 size: 0.0
312999 : 2.0737697278088114 size: 0.0
313999 : 1.8878943184093049 size: 0.0
314999 : 2.019259654635193 size: 0.0
315999 : 1.8020761795073195 size: 0.0
316999 : 1.9935843646878846 size: 0.0
317999 : 2.124762067841681 size: 0.0
318999 : 2.250875913823474 size: 0.0
319999 : 2.144427768019891 size: 0.0
320999 : 2.0261322533463217 size: 0.0
321999 : 1.9995074471835996 size: 0.0
322999 : 1.9098169469147872 size: 0.0
323999 : 1.8052525270861046 size: 0.0
324999 : 1.88887203977946 size: 0.0
325999 : 1.9597663841528252 size: 0.0
326999 : 2.113558773999176 size: 0.0
327999 : 2.082100051468653 size: 0.0
328999 : 2.16208815048904 size: 0.0
329999 : 1.90798172004743 size: 0.0
330999 : 1.8481768170016988 size: 0.0
331999 : 1.7051680833297476 size: 0.0
332999 : 1.8621538470373191 size: 0.0
333999 : 2.1742203226288552 size: 0.0
334999 : 2.1511374991606527 size: 0.0
335999 : 2.19874470467659 size: 0.0
336999 : 2.0664219410333486 size: 0.0
337999 : 1.999783823303536 size: 0.0
338999 : 1.9778333336086142 size: 0.0
339999 : 1.8981628865443707 size: 0.0
340999 : 1.8522614049596904 size: 0.0
341999 : 1.9355916428342945 size: 0.0
342999 : 2.0200091550276533 size: 0.0
343999 : 2.266847942609103 size: 0.0
344999 : 2.2174717235463905 size: 0.0
345999 : 2.0903443838030635 size: 0.0
346999 : 2.030917154658627 size: 0.0
347999 : 1.8611921200536945 size: 0.0
348999 : 1.6669731443302298 size: 0.0
349999 : 1.914287463941315 size: 0.0
350999 : 2.015527975076772 size: 0.0
351999 : 2.091692899768479 size: 0.0
352999 : 2.242415227314278 size: 0.0
353999 : 2.0197444737279753 size: 0.0
354999 : 1.9109733582591886 size: 0.0
355999 : 1.9330841357847148 size: 0.0
356999 : 1.8063616432015188 size: 0.0
357999 : 1.9819894663493647 size: 0.0
358999 : 1.9984542254297157 size: 0.0
359999 : 2.0307599625157384 size: 0.0
360999 : 2.207996167414453 size: 0.0
361999 : 2.0941768451948906 size: 0.0
362999 : 1.7987651695129088 size: 0.0
363999 : 1.9428811274911146 size: 0.0
364999 : 1.7438284073825 size: 0.0
365999 : 1.8145535208274162 size: 0.0
366999 : 2.1587946827250173 size: 0.0
367999 : 1.9867944896318208 size: 0.0
368999 : 2.1257358336108667 size: 0.0
369999 : 2.070037188337136 size: 0.0
370999 : 1.9794026752977372 size: 0.0
371999 : 1.8251584870275697 size: 0.0
372999 : 1.7240450710711002 size: 0.0
373999 : 1.7123043314446489 size: 0.0
374999 : 1.8533670814220875 size: 0.0
375999 : 2.1010147034105446 size: 0.0
376999 : 2.2486762557189386 size: 0.0
377999 : 2.1980416395998628 size: 0.0
378999 : 1.868011060177754 size: 0.0
379999 : 1.9306091334561482 size: 0.0
380999 : 1.9891786851207318 size: 0.0
381999 : 1.8409153655169692 size: 0.0
382999 : 1.9767871631434157 size: 0.0
383999 : 2.118878541355665 size: 0.0
384999 : 2.017715422413096 size: 0.0
385999 : 2.09074837104994 size: 0.0
386999 : 2.045777315606428 size: 0.0
last series
Last encode part don't need inference.
53.46650981903076
压缩完成，总共用时：7688.589869737625 秒
