FLAGS.seq_len change from 1 to 16 due to FLAGS.vocab_dim = 16 and FLAGS.hidden_dim = 256.
TestInitial.py:284: DeprecationWarning: The binary mode of fromstring is deprecated, as it behaves surprisingly on unicode inputs. Use frombuffer instead
  series = np.fromstring(fp.read(), dtype=np.uint8)
mlpCompressor(
  (input_map): Embedding(256, 16)
  (output_logit_map): Linear(in_features=256, out_features=256, bias=True)
  (layers): ModuleList(
    (0): BELayer(
      (V_map): dense_baens()
      (layernorm1): LayerNorm((16,), eps=1e-05, elementwise_affine=True)
      (layernorm2): LayerNorm((16,), eps=1e-05, elementwise_affine=True)
    )
    (1): LinearLayer(
      (U_map): Linear(in_features=256, out_features=4096, bias=True)
      (V_map): Linear(in_features=4096, out_features=256, bias=True)
      (layernorm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
      (layernorm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
    )
    (2): BELayer(
      (V_map): dense_baens()
      (layernorm1): LayerNorm((32,), eps=1e-05, elementwise_affine=False)
      (layernorm2): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
    )
    (3): LinearLayer(
      (U_map): Linear(in_features=256, out_features=4096, bias=True)
      (V_map): Linear(in_features=4096, out_features=256, bias=True)
      (layernorm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
      (layernorm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
    )
    (4): BELayer(
      (V_map): dense_baens()
      (layernorm1): LayerNorm((64,), eps=1e-05, elementwise_affine=False)
      (layernorm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
    )
    (5): LinearLayer(
      (U_map): Linear(in_features=256, out_features=4096, bias=True)
      (V_map): Linear(in_features=4096, out_features=256, bias=True)
      (layernorm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
      (layernorm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
    )
    (6): BELayer(
      (V_map): dense_baens()
      (layernorm1): LayerNorm((128,), eps=1e-05, elementwise_affine=False)
      (layernorm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
    (7): LinearLayer(
      (U_map): Linear(in_features=256, out_features=4096, bias=True)
      (V_map): Linear(in_features=4096, out_features=256, bias=True)
      (layernorm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
      (layernorm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
    )
  )
)
413916
999 : 2.7571715121148754 size: 0.0
1999 : 2.408533957713268 size: 0.0
2999 : 2.165147549865239 size: 0.0
3999 : 2.050746582320458 size: 0.0
4999 : 1.9869919257150113 size: 0.0
5999 : 1.8473361658042813 size: 0.0
6999 : 1.9761767967155035 size: 0.0
7999 : 1.7772852243507473 size: 0.0
8999 : 1.8147930926600682 size: 0.0
9999 : 1.7185555568382103 size: 0.0
10999 : 1.8338934858648916 size: 0.0
11999 : 1.983815750118877 size: 0.0
12999 : 1.849285933117113 size: 0.0
13999 : 1.7861306360499234 size: 0.0
14999 : 1.8599211682638181 size: 0.0
15999 : 1.6934423061939212 size: 0.0
16999 : 1.9091059706361202 size: 0.0
17999 : 1.7549799344470953 size: 0.0
18999 : 1.907807673604757 size: 0.0
19999 : 1.7211554185713034 size: 0.0
20999 : 1.9905290928953068 size: 0.0
21999 : 1.650450427096538 size: 0.0
22999 : 1.9330798362184431 size: 0.0
23999 : 1.6521597626634634 size: 0.0
24999 : 1.778949156497845 size: 0.0
25999 : 1.5518572449058123 size: 0.0
26999 : 1.7198376875003925 size: 0.0
27999 : 1.737997851552949 size: 0.0
28999 : 1.7010649212454625 size: 0.0
29999 : 1.83101088465378 size: 0.0
30999 : 1.6435147107525427 size: 0.0
31999 : 1.8643230642126518 size: 0.0
32999 : 1.712014540677945 size: 0.0
33999 : 1.6227488375567638 size: 0.0
34999 : 1.6206245078533064 size: 0.0
35999 : 1.5858279460348377 size: 0.0
36999 : 1.7093985125756708 size: 0.0
37999 : 1.8313761758042126 size: 0.0
38999 : 1.6753951347429814 size: 0.0
39999 : 1.7200984131991004 size: 0.0
40999 : 1.599007836483709 size: 0.0
41999 : 1.5919445090127735 size: 0.0
42999 : 1.6876912063490688 size: 0.0
43999 : 1.761126594388932 size: 0.0
44999 : 1.7043095459366404 size: 0.0
45999 : 1.7207104994535212 size: 0.0
46999 : 1.5958464513955488 size: 0.0
47999 : 1.4685376699555617 size: 0.0
48999 : 1.6098243413444235 size: 0.0
49999 : 1.6707902992661299 size: 0.0
50999 : 1.6864114834439987 size: 0.0
51999 : 1.655235500391494 size: 0.0
52999 : 1.7610462784909793 size: 0.0
53999 : 1.847539621280252 size: 0.0
54999 : 1.418008651184116 size: 0.0
55999 : 1.6381166912899117 size: 0.0
56999 : 1.5263926337058105 size: 0.0
57999 : 1.5612516252265423 size: 0.0
58999 : 1.7094678215839685 size: 0.0
59999 : 1.5654634803461724 size: 0.0
60999 : 1.5826739562006646 size: 0.0
61999 : 1.7112450902979848 size: 0.0
62999 : 1.5117973260403383 size: 0.0
63999 : 1.5162652633271032 size: 0.0
64999 : 1.748429115275731 size: 0.0
65999 : 1.4621973575488534 size: 0.0
66999 : 1.648932336237372 size: 0.0
67999 : 1.6238005114667897 size: 0.0
68999 : 1.6296778465773754 size: 0.0
69999 : 1.5216053246363934 size: 0.0
70999 : 1.4533476462834058 size: 0.0
71999 : 1.4820441554584214 size: 0.0
72999 : 1.6860941754531569 size: 0.0
73999 : 1.648984962928536 size: 0.0
74999 : 1.7188016640115948 size: 0.0
75999 : 1.7832368559665057 size: 0.0
76999 : 1.561173029155098 size: 0.0
77999 : 1.567849739626894 size: 0.0
78999 : 1.5322116666977537 size: 0.0
79999 : 1.4797435435378297 size: 0.0
80999 : 1.6976103057375813 size: 0.0
81999 : 1.5020299153498868 size: 0.0
82999 : 1.690655843284642 size: 0.0
83999 : 1.4232104384421125 size: 0.0
84999 : 1.764133883021919 size: 0.0
85999 : 1.6763702763733737 size: 0.0
86999 : 1.6042507275952618 size: 0.0
87999 : 1.6063582029989345 size: 0.0
88999 : 1.676307158740507 size: 0.0
89999 : 1.6647843211326987 size: 0.0
90999 : 1.6487901065851085 size: 0.0
91999 : 1.6188343404404753 size: 0.0
92999 : 1.5877749616252554 size: 0.0
93999 : 1.4972517213609653 size: 0.0
94999 : 1.473871195924119 size: 0.0
95999 : 1.7105471847007836 size: 0.0
96999 : 1.7304909808254383 size: 0.0
97999 : 1.5285128358256472 size: 0.0
98999 : 1.5448406967159114 size: 0.0
99999 : 1.3284794706418128 size: 0.0
100999 : 1.5380640643239643 size: 0.0
101999 : 1.5698235845108464 size: 0.0
102999 : 1.5081081261966802 size: 0.0
103999 : 1.627901953724566 size: 0.0
104999 : 1.5679419223277564 size: 0.0
105999 : 1.604771835027376 size: 0.0
106999 : 1.6953122735567525 size: 0.0
107999 : 1.6089988246202822 size: 0.0
108999 : 1.788257029545191 size: 0.0
109999 : 1.6510150461393207 size: 0.0
110999 : 1.5682432359320682 size: 0.0
111999 : 1.634212513132675 size: 0.0
112999 : 1.6615443399730943 size: 0.0
113999 : 1.5233791536973924 size: 0.0
114999 : 1.6578523884070224 size: 0.0
115999 : 1.5521731770354472 size: 0.0
116999 : 1.5671805551323867 size: 0.0
117999 : 1.723243287952778 size: 0.0
118999 : 1.6350873888776143 size: 0.0
119999 : 1.4393069826669662 size: 0.0
120999 : 1.7574989643342829 size: 0.0
121999 : 1.6581158658281443 size: 0.0
122999 : 1.5074324063614402 size: 0.0
123999 : 1.5427894596390708 size: 0.0
124999 : 1.524121774783818 size: 0.0
125999 : 1.5846612157313844 size: 0.0
126999 : 1.4941063306593354 size: 0.0
127999 : 1.6158114013862597 size: 0.0
128999 : 1.7382654565576916 size: 0.0
129999 : 1.6969815371660268 size: 0.0
130999 : 1.6166843853220394 size: 0.0
131999 : 1.4555158315628332 size: 0.0
132999 : 1.6131639004588776 size: 0.0
133999 : 1.6676980512036166 size: 0.0
134999 : 1.5685662193503884 size: 0.0
135999 : 1.5019886395136797 size: 0.0
136999 : 1.6414791240969304 size: 0.0
137999 : 1.620908107244579 size: 0.0
138999 : 1.3497358383578524 size: 0.0
139999 : 1.5287871481537734 size: 0.0
140999 : 1.4493679677424405 size: 0.0
141999 : 1.5209758681342356 size: 0.0
142999 : 1.659658034258431 size: 0.0
143999 : 1.64125778242527 size: 0.0
144999 : 1.6568294355996904 size: 0.0
145999 : 1.4901171930725725 size: 0.0
146999 : 1.6123204975390464 size: 0.0
147999 : 1.5869676750621056 size: 0.0
148999 : 1.640141958986472 size: 0.0
149999 : 1.5629809107809678 size: 0.0
150999 : 1.5621727643045635 size: 0.0
151999 : 1.5606266402733069 size: 0.0
152999 : 1.5153733612997287 size: 0.0
153999 : 1.7471879164844542 size: 0.0
154999 : 1.6976586328624739 size: 0.0
155999 : 1.6751350969748768 size: 0.0
156999 : 1.6411781544579205 size: 0.0
157999 : 1.6059186153433294 size: 0.0
158999 : 1.5788918857255405 size: 0.0
159999 : 1.7539387514787719 size: 0.0
160999 : 1.57996213376186 size: 0.0
161999 : 1.7710522291181774 size: 0.0
162999 : 1.5556413791727466 size: 0.0
163999 : 1.5953996404686073 size: 0.0
164999 : 1.7367107333938918 size: 0.0
165999 : 1.5980383702807954 size: 0.0
166999 : 1.6779721227835098 size: 0.0
167999 : 1.5517074480169109 size: 0.0
168999 : 1.58870074423485 size: 0.0
169999 : 1.5946750775605223 size: 0.0
170999 : 1.6777683233422374 size: 0.0
171999 : 1.6124606633994996 size: 0.0
172999 : 1.5532788534978443 size: 0.0
173999 : 1.5167935940305537 size: 0.0
174999 : 1.569105900908796 size: 0.0
175999 : 1.485766719936347 size: 0.0
176999 : 1.3751302806363022 size: 0.0
177999 : 1.6043083417833008 size: 0.0
178999 : 1.5517167350800574 size: 0.0
179999 : 1.6472714997779898 size: 0.0
180999 : 1.549312933568948 size: 0.0
181999 : 1.5560799349324468 size: 0.0
182999 : 1.4845523504386047 size: 0.0
183999 : 1.5465730779580524 size: 0.0
184999 : 1.5278589577870667 size: 0.0
185999 : 1.6123827552586587 size: 0.0
186999 : 1.5989029270666828 size: 0.0
187999 : 1.514395123981621 size: 0.0
188999 : 1.492192507720534 size: 0.0
189999 : 1.5441120062242057 size: 0.0
190999 : 1.4106967227913583 size: 0.0
191999 : 1.5770416963675584 size: 0.0
192999 : 1.5280287046634684 size: 0.0
193999 : 1.4555051686384797 size: 0.0
194999 : 1.5339552268122008 size: 0.0
195999 : 1.4383566065382982 size: 0.0
196999 : 1.4309573109589022 size: 0.0
197999 : 1.5832420148964645 size: 0.0
198999 : 1.5159978303050115 size: 0.0
199999 : 1.5605179472379616 size: 0.0
200999 : 1.4792733429703708 size: 0.0
201999 : 1.606426480111327 size: 0.0
202999 : 1.5491596970270292 size: 0.0
203999 : 1.34199541519047 size: 0.0
204999 : 1.4970394947698007 size: 0.0
205999 : 1.4626364292565062 size: 0.0
206999 : 1.57696825977564 size: 0.0
207999 : 1.793964961744677 size: 0.0
208999 : 1.6382068101989637 size: 0.0
209999 : 1.714195968621489 size: 0.0
210999 : 1.4812846800722113 size: 0.0
211999 : 1.5079683043015286 size: 0.0
212999 : 1.6135114773962713 size: 0.0
213999 : 1.5139054893746144 size: 0.0
214999 : 1.5514482701620604 size: 0.0
215999 : 1.682768202968121 size: 0.0
216999 : 1.6150109941291442 size: 0.0
217999 : 1.5592803600823528 size: 0.0
218999 : 1.5440079567204337 size: 0.0
219999 : 1.5829603073143512 size: 0.0
220999 : 1.4248561404282187 size: 0.0
221999 : 1.4244454458579583 size: 0.0
222999 : 1.5689285867957563 size: 0.0
223999 : 1.5666554920993025 size: 0.0
224999 : 1.6881421448596312 size: 0.0
225999 : 1.4767943850408343 size: 0.0
226999 : 1.6185309630443534 size: 0.0
227999 : 1.5117959501791314 size: 0.0
228999 : 1.5258890685040842 size: 0.0
229999 : 1.5812879480173612 size: 0.0
230999 : 1.454539658036536 size: 0.0
231999 : 1.5774326129329697 size: 0.0
232999 : 1.6979970947193719 size: 0.0
233999 : 1.4085917411361228 size: 0.0
234999 : 1.5350098244272916 size: 0.0
235999 : 1.596069168928416 size: 0.0
236999 : 1.5610509214729855 size: 0.0
237999 : 1.591670540649949 size: 0.0
238999 : 1.7386525895047837 size: 0.0
239999 : 1.599574519318302 size: 0.0
240999 : 1.5963832092488917 size: 0.0
241999 : 1.5825312106004485 size: 0.0
242999 : 1.5469858363201232 size: 0.0
243999 : 1.501218329220465 size: 0.0
244999 : 1.7002455958967522 size: 0.0
245999 : 1.5997790066901778 size: 0.0
246999 : 1.564660493349294 size: 0.0
247999 : 1.4994983307291863 size: 0.0
248999 : 1.7624940284459423 size: 0.0
249999 : 1.543171433106637 size: 0.0
250999 : 1.5873711463610296 size: 0.0
251999 : 1.4784889300997854 size: 0.0
252999 : 1.448184039173901 size: 0.0
253999 : 1.6318240180774923 size: 0.0
254999 : 1.5293173706663834 size: 0.0
255999 : 1.5011202991094734 size: 0.0
256999 : 1.5827678587280358 size: 0.0
257999 : 1.5886875015707336 size: 0.0
258999 : 1.3931972300920912 size: 0.0
259999 : 1.423542450949603 size: 0.0
260999 : 1.5543982885723102 size: 0.0
261999 : 1.5910182104552264 size: 0.0
262999 : 1.4571352202033574 size: 0.0
263999 : 1.4357677516948604 size: 0.0
264999 : 1.3166805148880443 size: 0.0
265999 : 1.3907674592007013 size: 0.0
266999 : 1.3798005555118071 size: 0.0
267999 : 1.3586127228821363 size: 0.0
268999 : 1.605478855705073 size: 0.0
269999 : 1.3891386975057052 size: 0.0
270999 : 1.3498582040139413 size: 0.0
271999 : 1.5334131374966813 size: 0.0
272999 : 1.3560330691105196 size: 0.0
273999 : 1.3189039925897241 size: 0.0
274999 : 1.4451150087692541 size: 0.0
275999 : 1.5814881358229655 size: 0.0
276999 : 1.3628091855545144 size: 0.0
277999 : 1.5491805069277835 size: 0.0
278999 : 1.5682177824997403 size: 0.0
279999 : 1.6591369268263167 size: 0.0
280999 : 1.4584950870237297 size: 0.0
281999 : 1.4940741699036242 size: 0.0
282999 : 1.46114224398581 size: 0.0
283999 : 1.5720299499387653 size: 0.0
284999 : 1.457528200560579 size: 0.0
285999 : 1.5685089491276512 size: 0.0
286999 : 1.4989639806329556 size: 0.0
287999 : 1.5114612719405522 size: 0.0
288999 : 1.5646113063111473 size: 0.0
289999 : 1.5995122615986896 size: 0.0
290999 : 1.546798031265381 size: 0.0
291999 : 1.4921923357378832 size: 0.0
292999 : 1.5494477679672243 size: 0.0
293999 : 1.459234440439789 size: 0.0
294999 : 1.5632457640632966 size: 0.0
295999 : 1.4903633002459573 size: 0.0
296999 : 1.5539518216106705 size: 0.0
297999 : 1.4434032654452165 size: 0.0
298999 : 1.47678956952661 size: 0.0
299999 : 1.4334308514349365 size: 0.0
300999 : 1.4904006204811946 size: 0.0
301999 : 1.3888547541491305 size: 0.0
302999 : 1.4069879169255017 size: 0.0
303999 : 1.5125124299026258 size: 0.0
304999 : 1.3206754998849366 size: 0.0
305999 : 1.469298177237677 size: 0.0
306999 : 1.5114494051376428 size: 0.0
307999 : 1.457950589951098 size: 0.0
308999 : 1.5100608172145764 size: 0.0
309999 : 1.530582647028781 size: 0.0
310999 : 1.522449415486828 size: 0.0
311999 : 1.3676258176659035 size: 0.0
312999 : 1.4814088515461343 size: 0.0
313999 : 1.3792395481046926 size: 0.0
314999 : 1.5864964425987413 size: 0.0
315999 : 1.5470140414748648 size: 0.0
316999 : 1.5148355715504807 size: 0.0
317999 : 1.4394447407703073 size: 0.0
318999 : 1.5004841352839318 size: 0.0
319999 : 1.4147035745911598 size: 0.0
320999 : 1.5049219756067957 size: 0.0
321999 : 1.382504208774696 size: 0.0
322999 : 1.5383882516208405 size: 0.0
323999 : 1.54475074978951 size: 0.0
324999 : 1.5731542005274555 size: 0.0
325999 : 1.5876999771894793 size: 0.0
326999 : 1.5458080991270147 size: 0.0
327999 : 1.5153484238153536 size: 0.0
328999 : 1.5590815481379554 size: 0.0
329999 : 1.4732904105121554 size: 0.0
330999 : 1.475279045904082 size: 0.0
331999 : 1.4912553742559826 size: 0.0
332999 : 1.4350101681178098 size: 0.0
333999 : 1.5014443144236989 size: 0.0
334999 : 1.549852959092657 size: 0.0
335999 : 1.5225476175804706 size: 0.0
336999 : 1.5763606450701417 size: 0.0
337999 : 1.6163804919779647 size: 0.0
338999 : 1.5819896372328814 size: 0.0
339999 : 1.6332688443273908 size: 0.0
340999 : 1.689530044852094 size: 0.0
341999 : 1.4540053079403052 size: 0.0
342999 : 1.3992161069243367 size: 0.0
343999 : 1.4789039242363176 size: 0.0
344999 : 1.3363833633188402 size: 0.0
345999 : 1.515293733332379 size: 0.0
346999 : 1.478334145714009 size: 0.0
347999 : 1.4436060329905838 size: 0.0
348999 : 1.2275665864562495 size: 0.0
349999 : 1.443994369816232 size: 0.0
350999 : 1.339292707832161 size: 0.0
351999 : 1.492282626629586 size: 0.0
352999 : 1.6216720541797116 size: 0.0
353999 : 1.5211241171792793 size: 0.0
354999 : 1.4243158569305332 size: 0.0
355999 : 1.6621093029811786 size: 0.0
356999 : 1.5166298665469322 size: 0.0
357999 : 1.5279148521485972 size: 0.0
358999 : 1.5825453131778193 size: 0.0
359999 : 1.4633821460306473 size: 0.0
360999 : 1.5441792514406931 size: 0.0
361999 : 1.6351219573904376 size: 0.0
362999 : 1.5549276511716659 size: 0.0
363999 : 1.5526229116674535 size: 0.0
364999 : 1.5009242388874897 size: 0.0
365999 : 1.5512147177221889 size: 0.0
366999 : 1.536553712684087 size: 0.0
367999 : 1.4788688397755414 size: 0.0
368999 : 1.5489947656648517 size: 0.0
369999 : 1.5438421654450019 size: 0.0
370999 : 1.550775474031885 size: 0.0
371999 : 1.597888401409243 size: 0.0
372999 : 1.3472979842818722 size: 0.0
373999 : 1.406961259614618 size: 0.0
374999 : 1.5214132200153796 size: 0.0
375999 : 1.4862037278521893 size: 0.0
376999 : 1.435730603442274 size: 0.0
377999 : 1.6191387497325025 size: 0.0
378999 : 1.5539065901734934 size: 0.0
379999 : 1.4641251110823745 size: 0.0
380999 : 1.5008485665211102 size: 0.0
381999 : 1.5641569281475678 size: 0.0
382999 : 1.5326202974762038 size: 0.0
383999 : 1.485774115190334 size: 0.0
384999 : 1.63387663101554 size: 0.0
385999 : 1.4743271219315564 size: 0.0
386999 : 1.5824701567593922 size: 0.0
387999 : 1.4734606733365097 size: 0.0
388999 : 1.59946049482078 size: 0.0
389999 : 1.4835349010761003 size: 0.0
390999 : 1.3974748685756764 size: 0.0
391999 : 1.499370719602246 size: 0.0
392999 : 1.472993568456766 size: 0.0
393999 : 1.4543769624488196 size: 0.0
394999 : 1.6705006804820768 size: 0.0
395999 : 1.631722892278785 size: 0.0
396999 : 1.4713231009689358 size: 0.0
397999 : 1.4473132910125825 size: 0.0
398999 : 1.444642572427334 size: 0.0
399999 : 1.5405241041619058 size: 0.0
400999 : 1.5750964006036492 size: 0.0
401999 : 1.505290018479642 size: 0.0
402999 : 1.3983001273258415 size: 0.0
403999 : 1.526508721995143 size: 0.0
404999 : 1.5013404369025778 size: 0.0
405999 : 1.5039191447696147 size: 0.0
406999 : 1.4608510773578993 size: 0.0
407999 : 1.3945527113548664 size: 0.0
408999 : 1.6423576114775378 size: 0.0
409999 : 1.486320848037427 size: 0.0
410999 : 1.4296466311766767 size: 0.0
411999 : 1.4639618995467059 size: 0.0
412999 : 1.549553537297505 size: 0.0
last series
Last encode part don't need inference.
40.30654430389404
压缩完成，总共用时：7990.461559057236 秒
